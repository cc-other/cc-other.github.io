<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>数字组合生成器</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 10px;
        }

        h1 {
            text-align: center;
        }

        textarea {
            width: 100%;
            margin-bottom: 10px;
            padding: 5px;
        }

        button {
            display: block;
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            font-size: 16px;
        }

        #info {
            text-align: center;
            margin-bottom: 20px;
        }

        #output {
            width: 100%;
            height: 200px;
            resize: vertical;
        }
    </style>
</head>
<body>
    <h1>数字组合生成器</h1>
    <label for="nums">输入自定义号码（用逗号分隔）：</label>
    <br>
    <textarea id="nums" rows="4" placeholder="例如：07-19-31-43-03-15-27-39-10-22-34-46"></textarea>
    <br>
    <button onclick="generateCombinations()">生成组合</button>
    <button onclick="clearInputs()">清空数据</button>
    <br>
    <div id="info">
        <p>计算: </p>
    </div>
    <textarea id="output" rows="10" readonly></textarea>
    <br>
    <button onclick="copyToClipboard()">复制结果</button>
    <button onclick="saveToFile()">保存结果</button>
	 <div id="info">
        <label for="target">开奖号码：</label>
        <textarea id="target" rows="4" placeholder="例如：07-19-31-43-03-15-27-39-10-22-34-46"></textarea>
    </div>
	 <button onclick="matchNumbers()">匹配</button>
    <div id="result"></div>
    <script>
        function generateCombinations() {
            let nums = document.getElementById("nums").value;
            let k = 3;  // 选择的数量

            // 生成组合
            let combinations = [];
            let numArray = nums.split("-");
            let n = numArray.length;

            for (let i = 0; i <= n - 3; i++) {
                for (let j = i + 1; j <= n - 2; j++) {
                    for (let m = j + 1; m <= n - 1; m++) {
                        let combination = [numArray[i].trim(), numArray[j].trim(), numArray[m].trim()];
                        combinations.push(combination);
                    }
                }
            }

            // 洗牌算法
            for (let i = combinations.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [combinations[i], combinations[j]] = [combinations[j], combinations[i]];
            }

            // 格式化输出
            let output = "";
            let count = 0;
            combinations.forEach(combination => {
                count++;
                output += combination.join("-").replace(/，/g, "-") + "  ";
                if (count % 30 === 0) {
                    output += "\n----------------------------------------------\n"; // 每30行后加分隔符
                } else if (count % 3 === 0) {
                    output += "\n"; // 每行打印三组分
                }
            });
			if(numArray.length<3){
				let generateInfo = "<p>计算: 输入信息错误！</p>";
				displayInfo(generateInfo);
				return;
			}
            let generateInfo = "<p>计算: " + nums.split(",").length + " 位，共 " + combinations.length + " 组</p>";
            // 将结果显示在文本框中
            document.getElementById("output").value = output;
            displayInfo(generateInfo);
        }

        function copyToClipboard() {
            /* Get the text field */
            let copyText = document.getElementById("output");

            /* Select the text field */
            copyText.select();
            copyText.setSelectionRange(0, 99999); /* For mobile devices */

            /* Copy the text inside the text field */
            document.execCommand("copy");

            /* Alert the copied text */
            alert("复制成功！");
        }

        function displayInfo(generateInfo) {
            let info = document.getElementById("info");
            info.innerHTML = generateInfo;
        }
        function clearInputs() {
            document.getElementById("nums").value = "";
			document.getElementById("output").value = "";
            document.getElementById("info").innerHTML = "<p>计算: </p>";
        }

        function saveToFile() {
            let outputText = document.getElementById("output").value;
            let blob = new Blob([outputText], { type: "text/plain;charset=utf-8" });
            let fileName = "三中三.txt";
            saveAs(blob, fileName);
        }

        function saveAs(blob, fileName) {
            let url = window.URL.createObjectURL(blob);
            let a = document.createElement("a");
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            setTimeout(function () {
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
            }, 0);
        }
		
		function inArray(array, element) {
    for (var i = 0; i < array.length; i++) {
        if (array[i] === element) {
            return true;
        }
    }
    return false;
}
function matchNumbers() {
    var numbers = document.getElementById("output").value.trim();
    var targetNumber = document.getElementById("target").value.trim();
    var pattern = /^(?!-)/; // 匹配行首不是连字符的行
    var splitRows = numbers.split("\n");
    var allDigits = [];
    // 将每行的数据进一步分割成数字组合
    splitRows.forEach(function (row) {
        if (pattern.test(row.trim())) {
            var digits = row.trim().split("  ");
            allDigits = allDigits.concat(digits);
        }
    });
    var matchedNumbers = allDigits.filter(function (number) {
        var targetDigits = targetNumber.split("-"); //匹配号码
        var digits_number = number.split("-"); //组合号码
        targetDigits.sort();
        digits_number.sort();
        var count = 0;
        for (var i = 0; i < digits_number.length; i++) {
            if (inArray(targetDigits, digits_number[i])) {
                count += 1;
            }
        }
        if (count >= 3) {
            return number;
        }
    });
    var resultDiv = document.getElementById("result");
    if (matchedNumbers.length >= 1) {
        resultDiv.innerHTML = "<p>匹配 - ["+matchedNumbers.length+"]</p><ul>";
        matchedNumbers.forEach(function (matched) {
            resultDiv.innerHTML += "<li>" + matched + "</li>";
        });
        resultDiv.innerHTML += "</ul>";
    } 
}
    </script>
</body>
</html>
